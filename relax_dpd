# Test created structure of MMT and modifier

units         lj
comm_modify   vel yes
newton        on
special_bonds lj/coul 1 1 1
atom_style    full
bond_style    harmonic
neighbor      3 bin
neigh_modify  delay 0 every 1 check no page 500000 one 50000


read_data     periodic_compoite.data
mass 1 1
mass 2 1.74
mass 3 1.74
mass 4 1.74

variable      dpdgamma   equal 5       # gamma from F_d
variable      pairradius equal 7       # cutoff for LJ (if set) and Coulomb
variable      dpdradius  equal 1.72    # r_c from F_c
variable      dpdradius2  equal 2.72    # r_c from F_c
variable      naradius   equal 1.22    # vdW radius of Na
variable      dpdcutoff  equal 2.0

#pair_coeff type type dpd A gamma cutoff

pair_style    hybrid/overlay coul/cut ${pairradius} dpd 1 ${dpdcutoff} 419084618
pair_coeff    1 1 dpd 0   ${dpdgamma}    # clay - clay
pair_coeff    1 2 dpd 100 ${dpdgamma} ${dpdradius2}    # clay - modifier head
pair_coeff    1 3 dpd 100 ${dpdgamma} ${dpdradius2}    # clay - modifier tail
pair_coeff    1 4 dpd 100 ${dpdgamma} ${dpdradius2}    # clay - polymer
pair_coeff    2 2 dpd 0.1  ${dpdgamma} ${dpdradius2}  # modifier head - modifier head
pair_coeff    2 3 dpd 0.1  ${dpdgamma} ${dpdradius2}    # modifier head - modifier tail
pair_coeff    2 4 dpd 0.1  ${dpdgamma} ${dpdradius2}    # modifier head - polymer
pair_coeff    3 3 dpd 0.1  ${dpdgamma} ${dpdradius2}    # modifier tail - modifier tail
pair_coeff    3 4 dpd 0.1  ${dpdgamma} ${dpdradius2}    # modifier tail - polymer
pair_coeff    4 4 dpd 0.1  ${dpdgamma} ${dpdradius2}    # polymer - polymer
pair_coeff    * * coul/cut
bond_coeff    1 1000 2                   # clay bonds: edge and
bond_coeff    2 1000 3.4641016151377544  # diagonal
bond_coeff    3 10   3.4641016151377544    # modifier head - tail
bond_coeff    4 10   3.4641016151377544    # modifier tail - tail
bond_coeff    5 10   3.4641016151377544    # polymer - polymer

thermo        10
#thermo_style  custom step density press pe ebond ecoul evdwl lz vol
thermo_style  custom step density press pe ebond ecoul evdwl lz

group         hard id 1:272
group         soft_rared id 273:6212:100
group         imagable union hard soft_rared
dump          d1 imagable image 1000 images_dump/*.jpg type type view 90 0

timestep      0.0001

#fix           1 all nvt temp 1 1 10000

fix           1 all npt x 0 0 10000 y 0 0 10000 z 1000 1000 10000 temp 1 1 10000

label loop
variable a loop 500
    run 5000 start 0 stop 2500000
    write_data dpd.*.data
    next a
jump SELF loop
